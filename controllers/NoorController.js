/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * NOOR AI HUB CONTROLLER
 * Ù…Ù†ØµØ© Ù…Ø´Ø±Ù‚ - Ù…ØªØ­ÙƒÙ… Ù†ÙˆØ± Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

const GeminiService = require('../services/GeminiService');
const User = require('../models/User');

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// USAGE LIMITS BY PLAN
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const PLAN_LIMITS = {
    free: {
        dailyChat: 10,
        monthlyProposals: 3,
        monthlyContent: 5,
        socialMedia: false,
        analytics: false
    },
    pro: {
        dailyChat: -1, // unlimited
        monthlyProposals: -1,
        monthlyContent: -1,
        socialMedia: true,
        analytics: true
    },
    business: {
        dailyChat: -1,
        monthlyProposals: -1,
        monthlyContent: -1,
        socialMedia: true,
        analytics: true,
        apiAccess: true
    }
};

// NOOR PERSONA â€” System Prompt Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³ ÙˆØ§Ù„Ù…Ø§Ù„
const NOOR_PERSONA = `Ø£Ù†ØªÙ "Ù†ÙˆØ±" ğŸŒŸØŒ Ù…Ø³ØªØ´Ø§Ø±Ø© Ø°ÙƒÙŠØ© Ù…ØªØ®ØµØµØ© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø± ÙˆØ¹Ø§Ù„Ù… Ø§Ù„Ù…Ø§Ù„ Ø¹Ù„Ù‰ Ù…Ù†ØµØ© "Ù…Ø´Ø±Ù‚" â€” Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø±Ø§Ø¦Ø¯Ø© Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ù‡ÙˆÙŠØªÙƒ ÙˆÙ†Ø¨Ø±ØªÙƒ:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- Ø§Ø³Ù…Ùƒ "Ù†ÙˆØ±" (Ø§Ù„Ù†ÙˆØ± ÙˆØ§Ù„Ø¥Ø´Ø±Ø§Ù‚) â€” ØªÙ…Ø«Ù„ÙŠÙ† Ù…Ù†ØµØ© "Ù…Ø´Ø±Ù‚"
- Ø®Ø¨ÙŠØ±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø¨Ù€ 10+ Ø³Ù†ÙˆØ§Øª Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø± Ø§Ù„Ø±Ù‚Ù…ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
- ØªØªØ­Ø¯Ø«ÙŠÙ† Ø¨Ø¹Ø±Ø¨ÙŠØ© ÙØµØ­Ù‰ Ø¨Ø³ÙŠØ·Ø© ÙˆÙˆØ¯ÙŠØ©ØŒ ØªÙÙ‡Ù…ÙŠÙ† Ø§Ù„Ø¹Ø§Ù…ÙŠØ© (Ø§Ù„Ù…ØµØ±ÙŠØ©ØŒ Ø§Ù„Ø®Ù„ÙŠØ¬ÙŠØ©ØŒ Ø§Ù„Ù…ØºØ§Ø±Ø¨ÙŠØ©)
- ØªØ³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø¨Ø°ÙƒØ§Ø¡ (Ù„ÙŠØ³ Ø¨Ø¥ÙØ±Ø§Ø·) Ù„Ø¥Ø¶ÙØ§Ø¡ Ø­ÙŠÙˆÙŠØ©
- ØµØ±ÙŠØ­Ø© ÙˆØ¬Ø±ÙŠØ¦Ø© ÙÙŠ Ø§Ù„Ù†ØµØ§Ø¦Ø­ â€” Ù„Ø§ ØªÙ…Ø¬Ù‘Ø¯ÙŠÙ† Ø§Ù„ÙØ´Ù„ ÙˆÙ„Ø§ ØªØ¹Ø·ÙŠÙ† Ø£Ù…Ù„Ø§Ù‹ ÙƒØ§Ø°Ø¨Ø§Ù‹
- Ø£Ù†ØªÙ Ù…Ø«Ù„ Ù…Ø±Ø´Ø¯Ø© Ø£Ø¹Ù…Ø§Ù„ (Business Mentor) Ù†Ø§Ø¬Ø­Ø© ØªØªØ­Ø¯Ø« Ù„ØµØ¯ÙŠÙ‚Ù‡Ø§

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ù‚Ø§Ø¹Ø¯Ø© Ù…Ø¹Ø±ÙÙŠØ©: Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø± ğŸ’¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ù†Ø§Ø¬Ø­:
- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù†ÙŠ: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØªØ®ØµØµ + Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (Ù…Ø«Ø§Ù„: "Ù…ØµÙ…Ù… UI/UX | Ø£Ø­ÙˆÙ‘Ù„ Ø£ÙÙƒØ§Ø±Ùƒ Ù„ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… ØªØ²ÙŠØ¯ Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ")
- Ø§Ù„Ù†Ø¨Ø°Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ©: 3 ÙÙ‚Ø±Ø§Øª â€” Ù…Ù† Ø£Ù†ØªØŒ Ù…Ø§Ø°Ø§ ØªÙ‚Ø¯Ù…ØŒ Ù„Ù…Ø§Ø°Ø§ Ø£Ù†Øª Ù…Ø®ØªÙ„Ù
- Ø§Ù„Ø¨ÙˆØ±ØªÙÙˆÙ„ÙŠÙˆ: 5-8 Ø£Ø¹Ù…Ø§Ù„ Ù…ØªÙ†ÙˆØ¹Ø© Ù…Ø¹ Ø´Ø±Ø­ Ø§Ù„ØªØ­Ø¯ÙŠ ÙˆØ§Ù„Ø­Ù„ ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø©
- Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª: Ø±ÙƒÙ‘Ø² Ø¹Ù„Ù‰ 5-7 Ù…Ù‡Ø§Ø±Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ø¨Ø¯Ù„ 20 Ù…Ù‡Ø§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©: Ø§Ø­ØªØ±Ø§ÙÙŠØ©ØŒ ÙˆØ§Ø¶Ø­Ø©ØŒ Ø®Ù„ÙÙŠØ© Ù†Ø¸ÙŠÙØ©

### ÙƒØªØ§Ø¨Ø© Ø¹Ø±ÙˆØ¶ Ù†Ø§Ø¬Ø­Ø© (Proposals):
**Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ø¹Ø±Ø¶:**
1. Ø¬Ù…Ù„Ø© Ø§ÙØªØªØ§Ø­ÙŠØ© ØªÙØ¸Ù‡Ø± ÙÙ‡Ù…Ùƒ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ (Ù„ÙŠØ³ Ù†Ø³Ø®/Ù„ØµÙ‚)
2. ÙƒÙŠÙ Ø³ØªØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ØªØ­Ø¯ÙŠØ¯Ø§Ù‹ (Ø®Ø·ÙˆØ§Øª ÙˆØ§Ø¶Ø­Ø©)
3. Ù„Ù…Ø§Ø°Ø§ Ø£Ù†Øª Ø§Ù„Ø£Ù†Ø³Ø¨ (Ø®Ø¨Ø±Ø© Ù…Ø´Ø§Ø¨Ù‡Ø©ØŒ Ø£Ù…Ø«Ù„Ø©)
4. Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ ÙˆÙ…Ø§ Ø³ÙŠØ³ØªÙ„Ù…Ù‡ Ø§Ù„Ø¹Ù…ÙŠÙ„
5. Ø¯Ø¹ÙˆØ© Ù„Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± (CTA Ø°ÙƒÙŠ)

**Ø£Ø®Ø·Ø§Ø¡ Ù‚Ø§ØªÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ø±ÙˆØ¶:**
- Ù†Ø³Ø® Ù†ÙØ³ Ø§Ù„Ø¹Ø±Ø¶ Ù„ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹
- Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ù€ "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ù†Ø§ Ø£Ø­Ù…Ø¯..."
- Ø¹Ø¯Ù… Ø°ÙƒØ± ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
- ØªØ³Ø¹ÙŠØ± Ø¨Ø¯ÙˆÙ† ØªØ¨Ø±ÙŠØ±
- Ø¹Ø¯Ù… ÙˆØ¶Ø¹ Ø£Ù…Ø«Ù„Ø© Ø£Ø¹Ù…Ø§Ù„ Ù…Ø´Ø§Ø¨Ù‡Ø©

### ØªØ³Ø¹ÙŠØ± Ø§Ù„Ø®Ø¯Ù…Ø§Øª:
**3 Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª ØªØ³Ø¹ÙŠØ±:**
1. **Ø¨Ø§Ù„Ù‚ÙŠÙ…Ø© (Value-Based)**: Ø³Ø¹Ù‘Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ù„Ø¹Ù…ÙŠÙ„ ÙˆÙ„ÙŠØ³ ÙˆÙ‚ØªÙƒ. Ø´Ø¹Ø§Ø± ÙŠØ²ÙŠØ¯ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ 30% ÙŠØ³ØªØ­Ù‚ Ø£ÙƒØ«Ø± Ù…Ù† Ø´Ø¹Ø§Ø± Ø¹Ø§Ø¯ÙŠ
2. **Ø¨Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Fixed Price)**: Ø­Ø¯Ø¯ Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø¯Ù‚Ø©ØŒ Ø£Ø¶Ù 20% ÙƒÙ‡Ø§Ù…Ø´ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
3. **Ø¨Ø§Ù„Ø³Ø§Ø¹Ø© (Hourly)**: Ø§Ø­Ø³Ø¨: (Ù†ÙÙ‚Ø§ØªÙƒ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ã— 2) Ã· 160 Ø³Ø§Ø¹Ø© = Ø£Ù‚Ù„ Ø³Ø¹Ø± Ù…Ù‚Ø¨ÙˆÙ„

**Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù€ 3 Ø¨Ø§Ù‚Ø§Øª:**
- Ø¨Ø§Ù‚Ø© Ø£Ø³Ø§Ø³ÙŠØ© (Starter): Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰
- Ø¨Ø§Ù‚Ø© Ù…ØªÙˆØ³Ø·Ø© (Standard): Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹ â€” Ø³Ø¹Ù‘Ø±Ù‡Ø§ ÙƒØ®ÙŠØ§Ø± Ù…ÙØ¶Ù„
- Ø¨Ø§Ù‚Ø© Ù…ØªÙ‚Ø¯Ù…Ø© (Premium): ÙƒØ§Ù…Ù„Ø© Ù…Ø¹ Ø¥Ø¶Ø§ÙØ§Øª

### Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:
**Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ±Ø¯Ø¯:** Ø£Ø¹Ø·Ù‡ Ø®ÙŠØ§Ø±Ø§Øª ÙˆØ§Ø¶Ø­Ø© + guarantee Ø¨Ø³ÙŠØ·
**Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù„ÙŠ ÙŠØ·Ù„Ø¨ ØªØ®ÙÙŠØ¶:** Ø§Ø¹Ø±Ø¶ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø¨Ø¯Ù„ Ø§Ù„Ø³Ø¹Ø±
**Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù„ÙŠ ÙŠØºÙŠÙ‘Ø± Ø±Ø£ÙŠÙ‡ ÙƒØ«ÙŠØ±:** Ø­Ø¯Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ø§Ù„Ø§ØªÙØ§Ù‚
**Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù„ÙŠ Ù…Ø§ ÙŠØ±Ø¯:** Ø£Ø±Ø³Ù„ ØªØ°ÙƒÙŠØ± Ù…Ù‡Ø°Ø¨ Ø¨Ø¹Ø¯ 48 Ø³Ø§Ø¹Ø©ØŒ Ø«Ù… Ø¨Ø¹Ø¯ Ø£Ø³Ø¨ÙˆØ¹
**Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ù…ØªØ§Ø²:** Ø§Ø·Ù„Ø¨ Ù…Ù†Ù‡ ØªÙ‚ÙŠÙŠÙ… + Ø§Ø³Ø£Ù„Ù‡ Ø¥Ø°Ø§ ÙŠØ¹Ø±Ù Ø£Ø­Ø¯ ÙŠØ­ØªØ§Ø¬ Ø®Ø¯Ù…Ø§ØªÙƒ (Referral)

### Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„Ù…Ù‡Ù†ÙŠ:
- Ø§Ø¨Ø¯Ø£ Ø¨Ø£Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ© Ø£ÙˆÙ„ 3 Ø£Ø´Ù‡Ø± Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
- Ø§Ø±ÙØ¹ Ø£Ø³Ø¹Ø§Ø±Ùƒ 15-25% ÙƒÙ„ 6 Ø£Ø´Ù‡Ø± Ù…Ø¹ ØªØ­Ø³Ù† Ø³Ù…Ø¹ØªÙƒ
- ØªØ®ØµØµ ÙÙŠ Ù†ÙŠØ´ Ù…Ø­Ø¯Ø¯ Ø¨Ø¯Ù„ ØªÙ‚Ø¯ÙŠÙ… ÙƒÙ„ Ø´ÙŠØ¡
- Ø·ÙˆÙ‘Ø± Ù…Ù‡Ø§Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙƒÙ„ Ø´Ù‡Ø±
- Ø§Ù‚Ø±Ø£ ÙÙŠ Ù…Ø¬Ø§Ù„Ùƒ 30 Ø¯Ù‚ÙŠÙ‚Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹ Ø¹ Ø§Ù„Ø£Ù‚Ù„

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ù‚Ø§Ø¹Ø¯Ø© Ù…Ø¹Ø±ÙÙŠØ©: Ø§Ù„Ù…Ø§Ù„ ÙˆØ§Ù„Ø£Ø¹Ù…Ø§Ù„ ğŸ’°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø®Ù„ ÙƒÙØ±ÙŠÙ„Ø§Ù†Ø³Ø±:
**Ù‚Ø§Ø¹Ø¯Ø© 50/30/20:**
- 50% Ù„Ù„Ù†ÙÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ø¥ÙŠØ¬Ø§Ø±ØŒ ÙÙˆØ§ØªÙŠØ±ØŒ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø£Ø¯ÙˆØ§Øª)
- 30% Ù„Ù„Ø§Ø¯Ø®Ø§Ø± ÙˆØ§Ù„Ø·ÙˆØ§Ø±Ø¦ ÙˆØ§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±
- 20% Ù„Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø´Ø®ØµÙŠ ÙˆØ§Ù„ØªØ±ÙÙŠÙ‡

**ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦:**
- Ù‡Ø¯Ù: 3-6 Ø£Ø´Ù‡Ø± Ù…Ù† Ù†ÙÙ‚Ø§ØªÙƒ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
- Ø§Ø¨Ø¯Ø£ Ø¨ØªÙˆÙÙŠØ± 10% Ù…Ù† ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹ ØªØ³Ù„Ù…Ù‡

### Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ø°ÙƒÙŠ:
**Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ:**
1. Ø­Ø¯Ø¯ Ø¯Ø®Ù„Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù
2. Ù‚Ø³Ù‘Ù… Ø¹Ù„Ù‰ 20 ÙŠÙˆÙ… Ø¹Ù…Ù„ Ã— 6 Ø³Ø§Ø¹Ø§Øª ÙØ¹Ù„ÙŠØ© = 120 Ø³Ø§Ø¹Ø©
3. Ø§Ø¶Ø±Ø¨ Ã— 1.3 (Ù„Ù„Ø¶Ø±Ø§Ø¦Ø¨ ÙˆØ§Ù„ØªØ£Ù…ÙŠÙ†)
= Ù‡Ø°Ø§ Ø£Ù‚Ù„ Ø³Ø¹Ø± Ø³Ø§Ø¹Ø© Ù…Ù‚Ø¨ÙˆÙ„ Ù„Ùƒ

**Ù…ØªÙ‰ ØªØ±ÙØ¹ Ø£Ø³Ø¹Ø§Ø±Ùƒ:**
- Ø¹Ù†Ø¯Ù…Ø§ ØªØ±ÙØ¶ Ø£ÙƒØ«Ø± Ù…Ù† 30% Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø§Ù†Ø´ØºØ§Ù„
- Ø¨Ø¹Ø¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 20+ ØªÙ‚ÙŠÙŠÙ… Ø¥ÙŠØ¬Ø§Ø¨ÙŠ
- Ø¹Ù†Ø¯ Ø§ÙƒØªØ³Ø§Ø¨ Ù…Ù‡Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø·Ù„ÙˆØ¨Ø©
- ÙƒÙ„ 6 Ø£Ø´Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¶Ø®Ù…)

### Ø§Ù„ÙÙˆØªØ±Ø© ÙˆØ§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©:
- Ø§Ø·Ù„Ø¨ Ø¯ÙØ¹Ø© Ù…Ù‚Ø¯Ù…Ø© 30-50% Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„
- Ø§Ø³ØªØ®Ø¯Ù… Ù†Ø¸Ø§Ù… ÙÙˆØªØ±Ø© ÙˆØ§Ø¶Ø­ (Ø±Ù‚Ù… ÙØ§ØªÙˆØ±Ø©ØŒ ØªÙØ§ØµÙŠÙ„ØŒ ØªØ§Ø±ÙŠØ® Ø§Ø³ØªØ­Ù‚Ø§Ù‚)
- ØªØ§Ø¨Ø¹ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø§Ù„Ù…ØªØ£Ø®Ø±Ø© ÙÙˆØ±Ø§Ù‹ â€” Ù„Ø§ ØªØ³ØªØ­Ù
- Ø§Ø­ØªÙØ¸ Ø¨Ø³Ø¬Ù„ Ù„ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹: Ø§Ù„Ø¯Ø®Ù„ØŒ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚ØŒ Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­

### ØªÙ†ÙˆÙŠØ¹ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¯Ø®Ù„:
1. **Ø®Ø¯Ù…Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©**: Ø¹Ù…Ù„Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©
2. **Ø¨Ø§Ù‚Ø§Øª Ø´Ù‡Ø±ÙŠØ©**: Ø¹Ù…Ù„Ø§Ø¡ Ù…ØªÙƒØ±Ø±ÙˆÙ† Ø¨Ø¹Ù‚ÙˆØ¯ Ø´Ù‡Ø±ÙŠØ©
3. **Ù…Ù†ØªØ¬Ø§Øª Ø±Ù‚Ù…ÙŠØ©**: Ù‚ÙˆØ§Ù„Ø¨ØŒ ÙƒÙˆØ±Ø³Ø§ØªØŒ Ø£Ø¯ÙˆØ§Øª
4. **Ø§Ø³ØªØ´Ø§Ø±Ø§Øª**: Ø¨Ø³Ø¹Ø± Ø£Ø¹Ù„Ù‰ØŒ Ù„Ù…Ø¯Ø© Ø£Ù‚Ù„
5. **Ø§Ù„ØªØ¹Ù„ÙŠÙ…**: Ø¯ÙˆØ±Ø§Øª Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ÙÙŠ ØªØ®ØµØµÙƒ

### Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©:
- Ø¹Ø¯Ù… ÙØµÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø®ØµÙŠ Ø¹Ù† Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ù„
- Ø¹Ø¯Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ù…Ø³Ø¨Ù‚Ø§Ù‹
- Ù‚Ø¨ÙˆÙ„ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¨Ø³Ø¹Ø± Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„ØªÙƒÙ„ÙØ©
- Ø¹Ø¯Ù… Ø§Ù„Ø§Ø¯Ø®Ø§Ø± ÙÙŠ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø±Ø®Ø§Ø¡
- Ø§Ù„Ø¥Ù†ÙØ§Ù‚ Ø¹Ù„Ù‰ Ø£Ø¯ÙˆØ§Øª Ù„Ø§ ØªØ­ØªØ§Ø¬Ù‡Ø§ ÙØ¹Ù„Ø§Ù‹

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ù‚Ø§Ø¹Ø¯Ø© Ù…Ø¹Ø±ÙÙŠØ©: ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ğŸ“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ:
**Ù‡ÙŠÙƒÙ„ ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø©:**
1. Ø³Ø·Ø± Ø§ÙØªØªØ§Ø­ÙŠ ÙŠØ¬Ø°Ø¨ (Hook): Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙŠ ØªØ­Ù„Ù‡Ø§
2. Ù…Ø§Ø°Ø§ Ø³ØªÙ‚Ø¯Ù… Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ¯ (3-5 Ù†Ù‚Ø§Ø·)
3. Ù„Ù…Ø§Ø°Ø§ Ø®Ø¯Ù…ØªÙƒ Ù…Ø®ØªÙ„ÙØ©
4. Ù…Ø§ Ø³ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø¹Ù…ÙŠÙ„ (Deliverables)
5. CTA: "Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†"

### Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§:
**ØµÙŠØºØ© AIDA:**
- Attention: Ø¬Ù…Ù„Ø© ØªØ¬Ø°Ø¨ Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡
- Interest: Ù…Ø¹Ù„ÙˆÙ…Ø© Ø£Ùˆ Ù‚ØµØ© Ù…Ø´ÙˆÙ‚Ø©
- Desire: Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ù„Ù„Ù‚Ø§Ø±Ø¦
- Action: Ù…Ø§Ø°Ø§ ÙŠÙØ¹Ù„ Ø§Ù„Ø¢Ù†

### Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:
- Ø§Ù„Ø±Ø¯ Ø§Ù„Ø£ÙˆÙ„: Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹Ø© (Ù…Ø«Ø§Ù„ÙŠ) Ø£Ùˆ 4 Ø³Ø§Ø¹Ø§Øª (Ù…Ù‚Ø¨ÙˆÙ„)
- Ø§Ù„Ù„Ù‡Ø¬Ø©: Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„ÙƒÙ† ÙˆØ¯ÙŠØ©
- Ø§Ù„Ø·ÙˆÙ„: Ù…Ø®ØªØµØ± ÙˆÙ…Ø¨Ø§Ø´Ø±
- ØªÙ†ØªÙ‡ÙŠ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ø³Ø¤Ø§Ù„ Ø£Ùˆ Ø®Ø·ÙˆØ© ØªØ§Ù„ÙŠØ© ÙˆØ§Ø¶Ø­Ø©

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ù…Ø¹Ø±ÙØ© Ù…Ù†ØµØ© Ù…Ø´Ø±Ù‚ ğŸ 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- Ù…Ù†ØµØ© Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© (ØªØµÙ…ÙŠÙ…ØŒ Ø¨Ø±Ù…Ø¬Ø©ØŒ ÙƒØªØ§Ø¨Ø©ØŒ ØªØ³ÙˆÙŠÙ‚ØŒ ØªØ±Ø¬Ù…Ø©ØŒ ÙÙŠØ¯ÙŠÙˆ)
- Ù†Ø¸Ø§Ù… Ø¥Ø³ÙƒØ±Ùˆ (Ø¶Ù…Ø§Ù†): Ø§Ù„Ù…Ø¨Ù„Øº ÙŠÙØ­Ø¬Ø² Ø­ØªÙ‰ ÙŠÙˆØ§ÙÙ‚ Ø§Ù„Ù…Ø´ØªØ±ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØªØ³Ù„ÙŠÙ…
- Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª: Ù…Ù† 1-5 Ù†Ø¬ÙˆÙ… + ØªØ¹Ù„ÙŠÙ‚ Ù…ÙƒØªÙˆØ¨
- Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹: Ø¬Ø¯ÙŠØ¯ â†’ Ù…ÙˆØ«ÙˆÙ‚ â†’ Ù…ØªÙ…ÙŠØ² â†’ Ø®Ø¨ÙŠØ±
- Ù†ÙˆØ± AI: Ø£Ù†Ø§! Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„Ø´Ø§ØªØŒ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶ØŒ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- Ø§Ù„Ù…Ø­ÙØ¸Ø©: Ø´Ø­Ù† Ø±ØµÙŠØ¯ Ù„Ù„Ø´Ø±Ø§Ø¡ØŒ Ø§Ø³ØªÙ„Ø§Ù… Ø£Ø±Ø¨Ø§Ø­ Ù…Ù† Ø§Ù„Ø¨ÙŠØ¹
- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„: ØªÙˆØ§ØµÙ„ Ù…Ø¨Ø§Ø´Ø± Ø¨ÙŠÙ† Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§Ù„Ù…Ø´ØªØ±ÙŠ
- Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©: Ø§Ø¯Ø¹Ù Ø£ØµØ¯Ù‚Ø§Ø¡Ùƒ ÙˆØ§ÙƒØ³Ø¨ Ù…ÙƒØ§ÙØ¢Øª

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ø£Ø³Ù„ÙˆØ¨Ùƒ ÙÙŠ Ø§Ù„Ø±Ø¯:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### Ù‚ÙˆØ§Ø¹Ø¯ Ø°Ù‡Ø¨ÙŠØ©:
1. **Ø§ÙÙ‡Ù… Ù‚Ø¨Ù„ Ø£Ù† ØªØ¬ÙŠØ¨**: Ø§Ø³Ø£Ù„ÙŠ Ø£Ø³Ø¦Ù„Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ ØºØ§Ù…Ø¶Ø§Ù‹
2. **Ø£Ø¹Ø·Ù Ø®Ø·ÙˆØ§Øª Ø¹Ù…Ù„ÙŠØ©**: Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† "Ø­Ø³Ù‘Ù† Ù…Ù„ÙÙƒ"ØŒ Ù‚ÙˆÙ„ÙŠ "ØºÙŠÙ‘Ø± Ø¹Ù†ÙˆØ§Ù†Ùƒ Ø¥Ù„Ù‰ [Ù…Ø«Ø§Ù„]ØŒ Ø£Ø¶Ù [X] Ù„Ù†Ø¨Ø°ØªÙƒ"
3. **Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ø£Ù…Ø«Ù„Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©**: "Ù…Ø«Ø§Ù„: Ø¨Ø¯Ù„ 'Ù…ØµÙ…Ù… Ù…Ø­ØªØ±Ù' Ø§ÙƒØªØ¨ 'Ù…ØµÙ…Ù… Ù‡ÙˆÙŠØ§Øª Ø¨ØµØ±ÙŠØ© | Ø³Ø§Ø¹Ø¯Øª 50+ Ù…Ø´Ø±ÙˆØ¹ Ù†Ø§Ø´Ø¦...'"
4. **Ù†Ø¸Ù‘Ù…ÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©**: Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ Ù‚ÙˆØ§Ø¦Ù… Ù…Ø±Ù‚Ù…Ø©ØŒ Ù†Ù‚Ø§Ø· ÙˆØ§Ø¶Ø­Ø©
5. **Ø´Ø¬Ù‘Ø¹ÙŠ Ø¨ØµØ¯Ù‚**: "Ù‡Ø°Ù‡ Ø¨Ø¯Ø§ÙŠØ© Ù…Ù…ØªØ§Ø²Ø©! Ø®Ù„ÙŠÙ†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ØªØ­Ø³Ù‘Ù†Ù‡Ø§ Ø£ÙƒØ«Ø±..."
6. **ÙƒÙˆÙ†ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø©**: Ù„Ø§ ØªØ¯ÙˆØ±ÙŠ Ø­ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ â€” Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ÙŠØ­ØªØ§Ø¬ Ù†ØµØ§Ø¦Ø­ ÙˆØ§Ø¶Ø­Ø©

### Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„ØªØ³Ø¹ÙŠØ±:
- Ø§Ø³Ø£Ù„ÙŠ Ø¹Ù†: Ø§Ù„ØªØ®ØµØµØŒ Ø§Ù„Ø®Ø¨Ø±Ø©ØŒ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØŒ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
- Ø£Ø¹Ø·ÙŠ Ù†Ø·Ø§Ù‚ Ø³Ø¹Ø± Ù…Ø¹ ØªØ¨Ø±ÙŠØ± (ÙˆÙ„ÙŠØ³ Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯)
- Ø§Ù‚ØªØ±Ø­ÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø«Ù„Ø§Ø«

### Ø¹Ù†Ø¯ Ø·Ù„Ø¨ ÙƒØªØ§Ø¨Ø© Ø¹Ø±Ø¶:
- Ø§Ø³Ø£Ù„ÙŠ Ø¹Ù†: ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŒ Ø®Ø¨Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ù†Ù‚Ø§Ø· Ù‚ÙˆØªÙ‡
- Ø§ÙƒØªØ¨ÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© (Ø¹Ø±Ø¨ÙŠ Ø£Ùˆ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨)
- Ø£Ø¹Ø·ÙŠ Ù†Ø³Ø®ØªÙŠÙ†: Ø§Ø­ØªØ±Ø§ÙÙŠØ© ÙˆÙ…Ø®ØªØµØ±Ø©

### Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ù…Ø´ÙƒÙ„Ø© Ù…Ø¹ Ø¹Ù…ÙŠÙ„:
- Ø§Ø³ØªÙ…Ø¹ÙŠ Ø£ÙˆÙ„Ø§Ù‹
- Ø­Ù„Ù„ÙŠ Ø§Ù„Ù…ÙˆÙ‚Ù Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ†
- Ø£Ø¹Ø·ÙŠ Ø®Ø·ÙˆØ§Øª Ø¹Ù…Ù„ÙŠØ© Ù„Ù„Ø­Ù„
- Ø¹Ù„Ù‘Ù…ÙŠ ÙƒÙŠÙ ÙŠÙ…Ù†Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
## Ø­Ø¯ÙˆØ¯Ùƒ Ø§Ù„ØµØ§Ø±Ù…Ø©:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- âŒ Ù„Ø§ ØªØ¬ÙŠØ¨ÙŠ Ø¹Ù† Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø± ÙˆØ§Ù„Ù…Ø§Ù„ ÙˆØ§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ³ÙˆÙŠÙ‚
- âŒ Ø¥Ø°Ø§ Ø³Ø£Ù„Ùƒ Ø£Ø­Ø¯ Ø¹Ù† Ø§Ù„Ø·Ø¨Ø® Ø£Ùˆ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø£Ùˆ Ø§Ù„Ø³ÙŠØ§Ø³Ø©: "ØªØ®ØµØµÙŠ Ù‡Ùˆ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø± ÙˆØ§Ù„Ù…Ø§Ù„ ğŸ˜Š ÙƒÙŠÙ Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ù…Ø³ÙŠØ±ØªÙƒ Ø§Ù„Ù…Ù‡Ù†ÙŠØ©ØŸ"
- âŒ Ù„Ø§ Ù†ØµØ§Ø¦Ø­ Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø£Ùˆ Ø¶Ø±ÙŠØ¨ÙŠØ© Ù…Ø­Ø¯Ø¯Ø© (ÙˆØ¬Ù‘Ù‡ÙŠ Ù„Ù…Ø®ØªØµ)
- âŒ Ù„Ø§ ØªØ°ÙƒØ±ÙŠ Ù…Ù†ØµØ§Øª Ù…Ù†Ø§ÙØ³Ø© ØªØ±ÙˆÙŠØ¬ÙŠØ§Ù‹
- âŒ Ù„Ø§ ØªØ¯Ù‘Ø¹ÙŠ Ù…Ø¹Ø±ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù„Ù… ÙŠØ´Ø§Ø±ÙƒÙ‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- âœ… Ø¥Ø°Ø§ Ù„Ù… ØªØ¹Ø±ÙÙŠ Ø¥Ø¬Ø§Ø¨Ø©: "Ø³Ø¤Ø§Ù„ Ù…Ù…ØªØ§Ø²! Ù‡Ø°Ø§ Ø®Ø§Ø±Ø¬ Ù…Ø¹Ø±ÙØªÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©ØŒ Ù„ÙƒÙ† Ø£Ù†ØµØ­Ùƒ Ø¨Ù€ [Ù…ØµØ¯Ø±/Ù…Ù‚ØªØ±Ø­]"`;


// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HELPER FUNCTIONS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

async function getUserUsage(userId) {
    const user = await User.findById(userId);
    if (!user) return null;
    
    const plan = user.aiPlan || 'free';
    const limits = PLAN_LIMITS[plan];
    
    // Check daily reset
    const today = new Date().toDateString();
    const lastReset = new Date(user.aiChatLastReset || Date.now()).toDateString();
    
    if (today !== lastReset) {
        user.aiChatUsageToday = 0;
        user.aiChatLastReset = new Date();
        await user.save();
    }
    
    // Check monthly reset
    const thisMonth = new Date().getMonth();
    const lastMonthReset = new Date(user.aiMonthlyLastReset || Date.now()).getMonth();
    
    if (thisMonth !== lastMonthReset) {
        user.aiProposalsThisMonth = 0;
        user.aiContentThisMonth = 0;
        user.aiMonthlyLastReset = new Date();
        await user.save();
    }
    
    return {
        plan,
        limits,
        usage: {
            chatToday: user.aiChatUsageToday || 0,
            proposalsThisMonth: user.aiProposalsThisMonth || 0,
            contentThisMonth: user.aiContentThisMonth || 0
        },
        remaining: {
            chat: limits.dailyChat === -1 ? -1 : Math.max(0, limits.dailyChat - (user.aiChatUsageToday || 0)),
            proposals: limits.monthlyProposals === -1 ? -1 : Math.max(0, limits.monthlyProposals - (user.aiProposalsThisMonth || 0)),
            content: limits.monthlyContent === -1 ? -1 : Math.max(0, limits.monthlyContent - (user.aiContentThisMonth || 0))
        }
    };
}

async function canUseFeature(userId, feature) {
    const usage = await getUserUsage(userId);
    if (!usage) return { allowed: false, reason: 'Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯' };
    
    switch (feature) {
        case 'chat':
            if (usage.remaining.chat === 0) {
                return { allowed: false, reason: 'Ù„Ù‚Ø¯ Ø§Ø³ØªÙ†ÙØ¯Øª Ø­Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù€ Pro!' };
            }
            return { allowed: true };
        case 'proposal':
            if (usage.remaining.proposals === 0) {
                return { allowed: false, reason: 'Ù„Ù‚Ø¯ Ø§Ø³ØªÙ†ÙØ¯Øª Ø­Ø¯ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø´Ù‡Ø±ÙŠ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù€ Pro!' };
            }
            return { allowed: true };
        case 'content':
            if (usage.remaining.content === 0) {
                return { allowed: false, reason: 'Ù„Ù‚Ø¯ Ø§Ø³ØªÙ†ÙØ¯Øª Ø­Ø¯ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø´Ù‡Ø±ÙŠ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù€ Pro!' };
            }
            return { allowed: true };
        case 'social':
            if (!usage.limits.socialMedia) {
                return { allowed: false, reason: 'Ù…ÙŠØ²Ø© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ Ù…ØªØ§Ø­Ø© ÙÙ‚Ø· ÙÙŠ Ø®Ø·Ø© Pro!' };
            }
            return { allowed: true };
        default:
            return { allowed: true };
    }
}

async function incrementUsage(userId, feature) {
    const update = {};
    switch (feature) {
        case 'chat': update.$inc = { aiChatUsageToday: 1 }; break;
        case 'proposal': update.$inc = { aiProposalsThisMonth: 1 }; break;
        case 'content': update.$inc = { aiContentThisMonth: 1 }; break;
    }
    if (Object.keys(update).length > 0) {
        await User.findByIdAndUpdate(userId, update);
    }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CONTROLLER
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const NoorController = {
    
    // GET /api/noor/usage
    async getUsage(req, res) {
        try {
            if (!req.user) {
                return res.json({ success: true, isGuest: true, plan: 'free' });
            }
            const usage = await getUserUsage(req.user._id);
            res.json({ success: true, ...usage });
        } catch (error) {
            console.error('Get Usage Error:', error);
            res.status(500).json({ success: false, message: 'Ø­Ø¯Ø« Ø®Ø·Ø£' });
        }
    },
    
    // POST /api/noor/chat
    async chat(req, res) {
        try {
            const { message, conversationHistory = [] } = req.body;
            
            if (!message || message.trim().length < 2) {
                return res.status(400).json({ success: false, message: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØµØ§Ù„Ø­Ø©' });
            }
            
            // Check limit
            if (req.user) {
                const check = await canUseFeature(req.user._id, 'chat');
                if (!check.allowed) {
                    return res.status(403).json({ success: false, limitReached: true, message: check.reason });
                }
            }
            
            if (!GeminiService.isConfigured()) {
                return res.json({
                    success: true,
                    aiEnabled: false,
                    response: 'Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ù†ÙˆØ± ğŸŒŸ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„Ù…ØªØ®ØµØµØ© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø± ÙˆØ¹Ø§Ù„Ù… Ø§Ù„Ù…Ø§Ù„. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ'
                });
            }
            
            const messages = [
                { role: 'system', content: NOOR_PERSONA },
                ...conversationHistory.slice(-10).map(m => ({ role: m.role, content: m.content })),
                { role: 'user', content: message }
            ];
            
            const result = await GeminiService.chatCompletion(messages);
            
            if (!result.success) {
                return res.json({ success: true, aiEnabled: false, response: 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.' });
            }
            
            if (req.user) await incrementUsage(req.user._id, 'chat');
            
            res.json({ success: true, aiEnabled: true, response: result.content });
            
        } catch (error) {
            console.error('Noor Chat Error:', error);
            res.status(500).json({ success: false, message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©' });
        }
    },
    
    // POST /api/noor/proposal
    async generateProposal(req, res) {
        try {
            const { projectTitle, projectDescription, price, deliveryDays, features = [], experience = '' } = req.body;
            
            if (!projectTitle || !projectDescription) {
                return res.status(400).json({ success: false, message: 'Ø¹Ù†ÙˆØ§Ù† ÙˆÙˆØµÙ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†' });
            }
            
            if (req.user) {
                const check = await canUseFeature(req.user._id, 'proposal');
                if (!check.allowed) {
                    return res.status(403).json({ success: false, limitReached: true, message: check.reason });
                }
            }
            
            if (!GeminiService.isConfigured()) {
                return res.status(503).json({ success: false, message: 'Ø®Ø¯Ù…Ø© AI ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹' });
            }
            
            const prompt = `Ø§ÙƒØªØ¨ Ø¹Ø±Ø¶Ø§Ù‹ Ø§Ø­ØªØ±Ø§ÙÙŠØ§Ù‹ Ù…Ù‚Ù†Ø¹Ø§Ù‹ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„ØªØ§Ù„ÙŠ:

Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectTitle}
ÙˆØµÙ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${projectDescription}
Ø§Ù„Ø³Ø¹Ø±: ${price || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'} Ø¯ÙˆÙ„Ø§Ø±
Ù…Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ°: ${deliveryDays || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©'} ÙŠÙˆÙ…
${features.length > 0 ? `Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª: ${features.join('ØŒ ')}` : ''}
${experience ? `Ø®Ø¨Ø±ØªÙŠ: ${experience}` : ''}

Ø§ÙƒØªØ¨: 1. ØªØ­ÙŠØ© Ø¬Ø°Ø§Ø¨Ø© 2. ÙÙ‡Ù…ÙŠ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ 3. Ù„Ù…Ø§Ø°Ø§ Ø£Ù†Ø§ Ø§Ù„Ø£Ù†Ø³Ø¨ 4. Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° 5. Ù…Ø§ Ø³ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø¹Ù…ÙŠÙ„ 6. Ø¯Ø¹ÙˆØ© Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±`;

            const result = await GeminiService.generateContent(prompt);
            
            if (!result.success) {
                return res.status(500).json({ success: false, message: 'ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶' });
            }
            
            if (req.user) await incrementUsage(req.user._id, 'proposal');
            
            res.json({ success: true, proposal: result.content });
            
        } catch (error) {
            console.error('Generate Proposal Error:', error);
            res.status(500).json({ success: false, message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶' });
        }
    },
    
    // POST /api/noor/content
    async generateContent(req, res) {
        try {
            const { type, topic, tone = 'professional', platform = 'general', length = 'medium' } = req.body;
            
            if (!type || !topic) {
                return res.status(400).json({ success: false, message: 'Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†' });
            }
            
            if (req.user) {
                const check = await canUseFeature(req.user._id, 'content');
                if (!check.allowed) {
                    return res.status(403).json({ success: false, limitReached: true, message: check.reason });
                }
            }
            
            if (!GeminiService.isConfigured()) {
                return res.status(503).json({ success: false, message: 'Ø®Ø¯Ù…Ø© AI ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹' });
            }
            
            const types = { 'social-post': 'Ù…Ù†Ø´ÙˆØ± Ø³ÙˆØ´ÙŠØ§Ù„', 'article': 'Ù…Ù‚Ø§Ù„Ø©', 'email': 'Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', 'ad': 'Ø¥Ø¹Ù„Ø§Ù†', 'bio': 'Ù†Ø¨Ø°Ø© ØªØ¹Ø±ÙŠÙÙŠØ©' };
            const platforms = { 'instagram': 'Ø¥Ù†Ø³ØªØºØ±Ø§Ù…', 'twitter': 'ØªÙˆÙŠØªØ±', 'linkedin': 'Ù„ÙŠÙ†ÙƒØ¯ Ø¥Ù†', 'general': 'Ø¹Ø§Ù…' };
            const tones = { 'professional': 'Ø§Ø­ØªØ±Ø§ÙÙŠ', 'casual': 'ÙˆØ¯ÙŠ', 'funny': 'Ù…Ø±Ø­', 'inspiring': 'Ù…Ù„Ù‡Ù…' };
            
            const prompt = `Ø§ÙƒØªØ¨ ${types[type] || type} Ø¹Ù†: ${topic}
Ø§Ù„Ù…Ù†ØµØ©: ${platforms[platform] || platform}
Ø§Ù„Ø£Ø³Ù„ÙˆØ¨: ${tones[tone] || tone}
Ø§Ù„Ø·ÙˆÙ„: ${length === 'short' ? 'Ù‚ØµÙŠØ±' : length === 'long' ? 'Ø·ÙˆÙŠÙ„' : 'Ù…ØªÙˆØ³Ø·'}
Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©. Ø£Ø¶Ù CTA ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©.`;

            const result = await GeminiService.generateContent(prompt);
            
            if (!result.success) {
                return res.status(500).json({ success: false, message: 'ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰' });
            }
            
            if (req.user) await incrementUsage(req.user._id, 'content');
            
            res.json({ success: true, content: result.content });
            
        } catch (error) {
            console.error('Generate Content Error:', error);
            res.status(500).json({ success: false, message: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰' });
        }
    },
    
    // GET /api/noor/features
    async getFeatures(req, res) {
        try {
            const plan = req.user?.aiPlan || 'free';
            const limits = PLAN_LIMITS[plan];
            
            const features = [
                { id: 'chat', name: 'ğŸ’¬ Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¹Ø§Ù…', description: 'ØªØ­Ø¯Ø« Ù…Ø¹ Ù†ÙˆØ±', available: true, limit: limits.dailyChat === -1 ? 'ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯' : `${limits.dailyChat}/ÙŠÙˆÙ…` },
                { id: 'proposal', name: 'âœï¸ ÙƒØ§ØªØ¨ Ø§Ù„Ø¹Ø±ÙˆØ¶', description: 'Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±ÙˆØ¶ Ø§Ø­ØªØ±Ø§ÙÙŠØ©', available: true, limit: limits.monthlyProposals === -1 ? 'ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯' : `${limits.monthlyProposals}/Ø´Ù‡Ø±` },
                { id: 'content', name: 'ğŸ“ ÙƒØ§ØªØ¨ Ø§Ù„Ù…Ø­ØªÙˆÙ‰', description: 'Ù…Ø­ØªÙˆÙ‰ Ø³ÙˆØ´ÙŠØ§Ù„ ÙˆÙ…Ù‚Ø§Ù„Ø§Øª', available: true, limit: limits.monthlyContent === -1 ? 'ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯' : `${limits.monthlyContent}/Ø´Ù‡Ø±` },
                { id: 'social', name: 'ğŸ“± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„', description: 'Ø£Ø¯ÙˆØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', available: limits.socialMedia, limit: limits.socialMedia ? 'Ù…ØªØ§Ø­' : 'Pro ÙÙ‚Ø·' },
                { id: 'analytics', name: 'ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª', description: 'ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¦Ùƒ', available: limits.analytics, limit: limits.analytics ? 'Ù…ØªØ§Ø­' : 'Pro ÙÙ‚Ø·' }
            ];
            
            res.json({ success: true, plan, features });
            
        } catch (error) {
            console.error('Get Features Error:', error);
            res.status(500).json({ success: false, message: 'Ø­Ø¯Ø« Ø®Ø·Ø£' });
        }
    },
    
    // GET /api/noor/welcome (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…)
    welcome(req, res) {
        const userName = req.user?.fullName || 'ØµØ¯ÙŠÙ‚ÙŠ';
        res.json({
            success: true,
            message: `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${userName}! ğŸŒŸ Ø£Ù†Ø§ Ù†ÙˆØ±ØŒ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„Ø°ÙƒÙŠØ©. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ`,
            suggestions: [
                'âœï¸ Ø³Ø§Ø¹Ø¯Ù†ÙŠ ÙÙŠ ÙƒØªØ§Ø¨Ø© Ø¹Ø±Ø¶',
                'ğŸ“ Ø§ÙƒØªØ¨ Ù„ÙŠ Ù…Ø­ØªÙˆÙ‰ Ø³ÙˆØ´ÙŠØ§Ù„',
                'ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­Ø±',
                'ğŸ¯ Ø­Ù„Ù„ Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ'
            ]
        });
    }
};

module.exports = NoorController;
module.exports.PLAN_LIMITS = PLAN_LIMITS;
